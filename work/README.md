## :pencil2: 工作记录

#### 1. 项目迁移，在新平台运行离线模式，事务数据页面的统计数据在旧平台看不到，新平台反而可以

- 当时的逻辑思维：查询数据库是否有数据；感觉PHP接口逻辑有问题不像是调用了统计接口，感觉是用了总览的数据。经前端定位后，仍不相信是用了这个接口，遂换个思路是否是客户端的合代码导致的问题，通过运行后的新旧平台的配置文件比对发现没有区别。（中途怀疑过是不是应该想简单模式一样写快照表，跟别人沟通没有拿出证据）最后看那段感觉有问题的PHP代码，发现旧平台使用了快照表。

  - 排查问题分三步：

    1. 落笔出排查问题的流程  

    2. 标记处那几个点会出问题 

    3. 根据情况排序摸查

       [不要跳跃胡思乱想]

#### 2. dev的机器：测试报告没数据, 请求不通

- 网络策略申请（极小概率：协议不通）
- 检查相关进程

#### 3. 机器裁撤

- netstat -nltp 检查进程 
- 检查相关配置文件 
- 修改防火墙（断网）
- 重新再新机器部署服务，修改相关配置，验证服务及数据迁移成功

#### 4. 涉及新功能

- 了解其他第三方服务的架构和使用流程
- demo使用和环境搭建
- 具体实现步骤（概要设计-详细设计）
- 问题顾虑（各种方案的优缺点）、测试流程和全面性、性能

#### 5.线上问题处理

##### 5.1 线上服务不可用

查问题链路：先各种重启，无果。查看sc日志显示redis连接不上。重启redis，可以运行，但发现没有数据上报。发现kafka&zk没了。导致zk没了有两个原因磁盘满了+不完整数据。
总结：线上发现问题给自己10min解决时间，处理不来赶紧摇人。看日志！！！看日志！！！看日志！！！

##### 5.2 线上问题定位

1. 确认是否为群体问题

2. 资源包md5 二进制是否一致

3. 到预发布复现

   **EG 20211222**

   1. 业务逻辑
   2. 性能
   3. 多方面的信息  业务日志  系统日志    网络（timewait）
   4. 测试服复现故障加以验证



#### 6.方案设计

1. 方案设计要给人形成一种整体流程的观念，给他人一种宏观逻辑上的概念。不需要从每一个细节讲起，会给人造成需要理解“新词汇”的情况。
2. 概要设计要知道详细设计的异常情况，以及实际生产情况的问题。
3. 为了给人讲清楚，可以先进行文字描写，让非面对面的人读完后，能知道你在说什么。
4. 方案选型：方案间需对比，结合工时、技术难度等评估：选择一个后期难以改变但快速时间，渐进式优选方案，直接优选方案？
5. 大型方案思考&学习
   1. ）能选开源选开源，问题好查询，写法规则可读性较高
   2. ）充分理解开源项目流程+业务需求
   3. ） 图省事&通用标准方法：开源升级埋下隐患；方案设计尽可能的考虑周全或多花点时间，但要说明进度，在哪里花了时间
   4. ）打日志验证，不要过早复杂操作以验证自己的想法

#### 7.CICD

	1. 流水线的结果不是真正的结果，要去实际看进程。



#### 8.代码实践

1. 外部来的东西都不要相信，自己要进行验证和逻辑处理。

#### TIPS

- 软技能
  - 沟通有响应，二次确认理解得对不对。有疑惑的地方要及时问。
  - 客户反应的问题要让其复现，并同时定位。

- 实践技能
  - 非发布内容尽可能的不要动，不得已动了必须各种测试
  - mysql不要用客户端操作，规避大小写带来的问题
  - 功能尽可能的单步调试，单个服务本地更新（cgdb）



